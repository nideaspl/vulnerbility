id: CVE-2024-6387
info:
  name: OpenSSH Version Detection
  author: Xinyi
  severity: high
  description: |
    Detects if OpenSSH service is running on the target host and extracts the version information from SSH banner.
  tags:
    - ssh
    - openssh
    - version-detect
    - detection
tcp:
  - host:
      - "{{Hostname}}"
    port: 22

    matchers:
      - type: regex
        regex:
          - 'OpenSSH_(8\.5p1|8\.6p1|8\.7p1|8\.8p1|8\.9p1|9\.0p1|9\.1p1|9\.2p1|9\.3p1|9\.4p1|9\.5p1|9\.6p1|9\.7p1)'

    extractors:
      - type: regex
        regex:
          - 'OpenSSH_(8\.5p1|8\.6p1|8\.7p1|8\.8p1|8\.9p1|9\.0p1|9\.1p1|9\.2p1|9\.3p1|9\.4p1|9\.5p1|9\.6p1|9\.7p1)'
